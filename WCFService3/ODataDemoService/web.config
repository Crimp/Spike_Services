<?xml version="1.0" encoding="UTF-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <connectionStrings>
    <add name="ApplicationServices" connectionString="User ID=Test4;Password=1tr.erweerT;Pooling=false;Data Source=minakov-w8;Initial Catalog=MainDemo_v12.1" providerName="System.Data.SqlClient" />
  </connectionStrings>
  <system.web>
    <machineKey decryption="AES" decryptionKey="0CA3EFAF0F7A5E7A62681C0BF656EE0ECE31ACEE3E1023BA3FAD20EA5F199DE8" validation="SHA1" validationKey="BF5404525BDD2B09B6A3094AACB09D072C24524F9DE62168764FF0DCE537184F0535D5D9AD66DEDC97DC1ABFF7FA540B4DFD82E5BB196B95D15FF81F75AD5328" />
    <roleManager defaultProvider="AspNetWindowsTokenRoleProvider" />
    <compilation debug="true" targetFramework="4.0" />
    <membership>
      <providers>
        <clear />
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
      </providers>
    </membership>
    <profile>
      <providers>
        <clear />
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>
    <authentication mode="Windows" />
    <!--<roleManager enabled="false">
      <providers>
        <clear />
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>-->
  </system.web>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <!--<add name="WindowsAuthentication" type="System.Web.Security.WindowsAuthenticationModule" />-->
      <!--<add name="FormsAuthenticationModule" type="FormsAuthenticationModule" />-->
    </modules>
    <staticContent>
      <remove fileExtension=".cer" />
      <mimeMap fileExtension=".cer" mimeType="application/x-x509-ca-cert" />
    </staticContent>
  </system.webServer>
  <system.serviceModel>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" aspNetCompatibilityEnabled="true">
      <serviceActivations>
        <add relativeAddress="ODataDemoService/AuthenticationService.svc" service="AuthenticationService" />
        <add relativeAddress="ODataDemoService/DemoODataDemoService.svc" service="DemoODataDemoService" />
      </serviceActivations>
    </serviceHostingEnvironment>
    <services>
      <service behaviorConfiguration="MyBehaviour" name="AuthenticationService">
        <endpoint address="" binding="webHttpBinding" bindingConfiguration="ClientCertificateTransportSecurity"
          name="MyEndPoint" contract="IAuthenticationService" />
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
      <service behaviorConfiguration="MyBehaviour" name="DemoODataDemoService" >
        <endpoint  binding="webHttpBinding" bindingConfiguration="ClientCertificateTransportSecurity_DataService"
          name="MyEndPoint" contract="System.Data.Services.IRequestHandler" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="MyBehaviour">
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
        <behavior name="">
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <bindings>
      <webHttpBinding>
        <binding name="ClientCertificateTransportSecurity">
          <security mode="TransportCredentialOnly">
            <transport clientCredentialType="Windows" proxyCredentialType="Windows">
              <extendedProtectionPolicy policyEnforcement="Always"/>
            </transport>
          </security>
        </binding>
        <binding name="ClientCertificateTransportSecurity_DataService">
          <security mode="Transport">
            <transport clientCredentialType="Windows" proxyCredentialType="Windows">
              <extendedProtectionPolicy policyEnforcement="Always"/>
            </transport>
          </security>
        </binding>
      </webHttpBinding>
    </bindings>
  </system.serviceModel>
</configuration>